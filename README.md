> [!NOTE]
> This README was generated by [SKILL](https://github.com/pardnchiu/skill-readme-generate), get the ZH version from [here](./doc/README.zh.md).

![cover](./cover.png)

# go-faas

[![pkg](https://pkg.go.dev/badge/github.com/pardnchiu/go-faas.svg)](https://pkg.go.dev/github.com/pardnchiu/go-faas)
[![card](https://goreportcard.com/badge/github.com/pardnchiu/go-faas)](https://goreportcard.com/report/github.com/pardnchiu/go-faas)
[![license](https://img.shields.io/github/license/pardnchiu/go-faas)](LICENSE)
[![version](https://img.shields.io/github/v/tag/pardnchiu/go-faas?label=release)](https://github.com/pardnchiu/go-faas/releases)

> A lightweight Function-as-a-Service platform that accepts code via HTTP API and executes it securely inside a Bubblewrap sandbox.

## Table of Contents

- [Features](#features)
- [Architecture](#architecture)
- [File Structure](#file-structure)
- [License](#license)
- [Author](#author)
- [Stars](#stars)

## Features

> `go install github.com/pardnchiu/go-faas/cmd/api@latest` · [Documentation](./doc/doc.md)

### Bubblewrap Sandbox Isolation

All user-submitted code runs inside a Bubblewrap sandbox with full Linux namespace isolation covering filesystem, network, and process space. Every capability is dropped, and only read-only system paths and the wrapper script are mounted, ensuring user code cannot access host resources or make outbound connections.

### Multi-Language Execution with Version Control

Accept and execute Python, JavaScript, and TypeScript code through a unified HTTP API. Scripts are versioned and stored in Redis with automatic timestamp-based versioning on each upload, allowing callers to target a specific version or always run the latest iteration.

### Systemd Slice Resource Control

Each sandbox process is launched via systemd-run under a dedicated systemd slice that enforces CPU quota and memory ceiling. When a script exceeds its resource budget, the system terminates it at the kernel level, preventing any single execution from degrading overall service stability.

## Architecture

```mermaid
graph TB
    Client[HTTP Client] -->|POST /upload| Upload[Upload Handler]
    Client -->|POST /run/*path| Run[Run Handler]
    Client -->|POST /run-now| RunNow[RunNow Handler]

    Upload -->|Store script| Redis[(Redis)]
    Run -->|Fetch script| Redis
    Run --> Sandbox
    RunNow --> Sandbox

    subgraph Sandbox[Bubblewrap Sandbox]
        SystemdRun[systemd-run] --> Bwrap[bwrap]
        Bwrap --> Wrapper[Wrapper Script]
        Wrapper --> UserCode[User Code]
    end

    Sandbox -->|stdout/stderr| SSE[SSE Stream / JSON Response]
    SSE --> Client
```

## File Structure

```
go-faas/
├── cmd/
│   └── api/
│       └── main.go              # Entry point
├── internal/
│   ├── router.go                # HTTP route definitions
│   ├── checker/
│   │   └── checker.go           # Dependency check and auto-install
│   ├── database/
│   │   └── redis.go             # Redis script storage and versioning
│   ├── handler/
│   │   ├── run.go               # Code execution handler
│   │   ├── upload.go            # Script upload handler
│   │   └── sse.go               # SSE streaming output
│   ├── sandbox/
│   │   ├── command.go           # Bubblewrap sandbox command builder
│   │   └── slice.go             # Systemd slice resource limits
│   ├── resource/
│   │   ├── wrapper.py           # Python wrapper
│   │   ├── wrapper.js           # JavaScript wrapper
│   │   └── wrapper.ts           # TypeScript wrapper
│   └── utils/
│       └── getEnv.go            # Environment variable helpers
├── .env.example
├── go.mod
└── LICENSE
```

## License

This project is licensed under the [MIT LICENSE](LICENSE).

## Author

<img src="https://avatars.githubusercontent.com/u/25631760" align="left" width="96" height="96" style="margin-right: 0.5rem;">

<h4 style="padding-top: 0">邱敬幃 Pardn Chiu</h4>

<a href="mailto:dev@pardn.io" target="_blank">
<img src="https://pardn.io/image/email.svg" width="48" height="48">
</a> <a href="https://linkedin.com/in/pardnchiu" target="_blank">
<img src="https://pardn.io/image/linkedin.svg" width="48" height="48">
</a>

## Stars

[![Star](https://api.star-history.com/svg?repos=pardnchiu/go-faas&type=Date)](https://www.star-history.com/#pardnchiu/go-faas&Date)

***

©️ 2025 [邱敬幃 Pardn Chiu](https://linkedin.com/in/pardnchiu)
